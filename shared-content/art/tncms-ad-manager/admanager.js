if(typeof TNCMS_DotConnect_Tile!="number"&&(TNCMS_DotConnect_Tile=1),typeof TNCMS_Used_Ad>"u"&&(TNCMS_Used_Ad={}),Object.create||(Object.create=function(e){var t=function(){};return t.prototype=e,new t}),typeof TNCMS_PAGE_LOADED!="boolean"){let e=function(){TNCMS_PAGE_LOADED=!0};var pageLoaded=e;TNCMS_PAGE_LOADED=!1,window.addEventListener?window.addEventListener("load",e,!1):window.attachEvent?window.attachEvent("onload",e):(priorOnLoad=window.onload,typeof window.onload!="function"?window.onload=e:window.onload=function(){priorOnLoad&&priorOnLoad(),e()})}window.TNCMS||(window.TNCMS={}),window.TNCMS.AdManager||(window.TNCMS.AdManager=function(){var kDomain={},kPositionList={},kRenderedPositionList={},sDefaultDomain=null,kGoogleSlots={},sDefaultSecureDomain=null,isSecure=location.protocol=="https:",kAdList={},aRenderAdList=[],iDebug=location.search.match(/(\?|\&)adman_debug_mode=(\d+)/)?RegExp.$2:0,bCanLog=!1,kLocation=!1,bTracker=!1,kImpressions={},kTraffic={},kSettings={},kAdCallback={dotconnect:function(e){var t=window.location.pathname,o=t.split("/"),n="frontpage",l=e.domain.replace("www.","");o.length>1&&o[1].indexOf(".")==-1&&(n=o[1]);var c="";if(e.fold&&(e.fold=="above"?c="atf":e.fold=="below"?c="btf":e.fold=="span"&&(c="stf")),!window.googletag&&(window.googletag={},document.getElementById("dotconnect-gpt-load")===null)){var m=document.createElement("script");m.id="dotconnect-gpt-load",m.async=!0,m.type="text/javascript";var k=document.location.protocol=="https:";m.src=(k?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var f=document.getElementsByTagName("head")[0];f.appendChild(m,f)}var v=window.googletag||{};if(v.cmd=v.cmd||[],kGoogleSlots[e.adid])v.pubads().refresh([kGoogleSlots[e.adid]]);else{for(;e.positionDiv&&e.positionDiv.firstChild;)e.positionDiv.removeChild(e.positionDiv.firstChild);v.cmd.push(function(){kGoogleSlots[e.adid]=v.defineSlot("/132916964/"+l,[parseInt(e.width),parseInt(e.height)],e.positionDiv.id).addService(v.pubads()).setTargeting("pos",c),v.pubads().setTargeting("sec",n),v.enableServices(),v.display(e.positionDiv.id)}),e.positionDiv.className="tncms-iq-ad",TNCMS_DotConnect_Tile++}},expandable:function(e){var t=e.title?e.title:"*",o='<img src="'+e.smallImage+'" alt="'+t+'" border="0" id="expandable_'+e.adid+`" onmouseover="document.getElementById('expandable_`+e.adid+"').src = '"+e.largeImage+`'" onmouseout="document.getElementById('expandable_`+e.adid+"').src = '"+e.smallImage+`'"/>`;e.clickuri&&(o='<a rel="nofollow" href="http:'+e.clickuri+'" target="_blank">'+o+"</a>"),e.positionDiv.innerHTML=o},html5:function(e){if(e.positionDiv.hasChildNodes())for(info("Position "+e.position+" has child nodes. Removing child nodes for refresh.");e.positionDiv.firstChild;)e.positionDiv.removeChild(e.positionDiv.firstChild);var t=document.createElement("iframe");t.setAttribute("id","html5-ad-frame-"+e.adid),t.setAttribute("width",e.width),t.setAttribute("height",e.height),t.setAttribute("marginwidth",0),t.setAttribute("marginheight",0),t.setAttribute("hspace",0),t.setAttribute("vspace",0),t.setAttribute("frameborder",0),t.setAttribute("scrolling","no"),t.setAttribute("sandbox","allow-forms allow-popups allow-same-origin allow-scripts");var o="https://"+e.cdn+"/content/tncms/ads/__html5/"+e.uuid+"/"+e.html5_id+"/"+e.htmlfile;e.clickuri&&(o+="?clickTag="+encodeURIComponent(e.clickuri)),t.src=o,e.positionDiv.appendChild(t)},html:function(e){if(e.height!=null&&e.height!=""){if(e.positionDiv.hasChildNodes())for(info("Position "+e.position+" has child nodes. Removing child nodes for refresh.");e.positionDiv.firstChild;)e.positionDiv.removeChild(e.positionDiv.firstChild);var t=document.createElement("iframe");t.setAttribute("id","html-ad-frame-"+e.adid),t.setAttribute("width",e.width),t.setAttribute("height",e.height),t.setAttribute("marginwidth",0),t.setAttribute("marginheight",0),t.setAttribute("hspace",0),t.setAttribute("vspace",0),t.setAttribute("frameborder",0),t.setAttribute("scrolling","no");var o='<script type="text/javascript">var ';o+="inDapIF = true;<\/script>"+e.html,o=o.replace(/[-[\]\/{}()*+?.\\^$|'"]/g,"\\$&"),t.src="javascript:'"+o+"'",e.positionDiv.appendChild(t)}else{e.positionDiv.innerHTML=e.html,aChildNode=e.positionDiv.childNodes;for(var n=0;aChildNode[n];n++)if(aChildNode[n].nodeName&&aChildNode[n].nodeName.toLowerCase()==="script"&&(!aChildNode[n].type||aChildNode[n].type.toLowerCase()==="text/javascript")){if(oNode=aChildNode[n].parentNode?aChildNode[n].parentNode.removeChild(aChildNode[n]):aChildNode[n],oNode.src)info("Ad #"+e.adid+": Loading script: "+oNode.src+" on "+e.position),jsLoader.loadScript(oNode.src,"blox-ad-position-"+e.position);else{info("Ad #"+e.adid+": Running inline script: on "+e.position),sData=oNode.text||oNode.textContent||oNode.innerHTML||"";var l=document.getElementsByTagName("head")[0]||document.documentElement,c=document.createElement("script");c.type="text/javascript",c.appendChild(document.createTextNode(sData)),oldDocumentWrite=document.write,document.write=function(m){e.positionDiv.innerHTML+=m},l.insertBefore(c,l.firstChild),l.removeChild(c),document.write=oldDocumentWrite}oNode.parentNode&&oNode.parentNode.removeChild(oNode)}}},image:function(e){alt=e.title?e.title:"*",sHeight=e.height?' height="'+e.height+'"':"",sWidth=e.width?' width="'+e.width+'"':"",sOnClick="",e.clickuri&&(sOnClick=` onclick="window.open('`+e.clickuri+`','_blank');" style="cursor: pointer;"`),e.positionDiv.innerHTML='<img src="'+e.asseturl+'" alt="'+alt+'" border="0"'+sHeight+sWidth+sOnClick+"/>"},pagecurl:function(e){},text:function(e){e.positionDiv.innerHTML='<a rel="nofollow" href="'+e.clickuri+'" target="_blank">'+e.title+"</a><br />"+e.text},video:function(e){renderStandaloneVideo(e)}},kVirtualRegionCallback={popunder:function(e){if(e.type=="expandable"||e.type=="pagecurl")throw new Error("Ad type "+e.type+"is not allowed in a popunder.");iWidth=e.width?parseInt(e.width,10)+30:300,iHeight=e.height?parseInt(e.height,10)+100:300,iLeft=(screen.width-iWidth)/2,iTop=(screen.height-iHeight)/2,e.window=window.open("","tncms_adman_popunder","top="+iTop+", left="+iLeft+",width="+iWidth+",height="+iHeight+",scrollbars=0,resizable=0,toolbar=0,location=0,menubar=0,status=0,directories=0"),e.positionDiv=e.window.document.body,e.positionDiv.setAttribute("id","blox-ad-position-"+e.position),e.positionDiv.innerHTML="",e.window.blur(),window.focus(),e.window.document.title=e.title,e.window.resizeTo(iWidth,iHeight),e.window.moveTo(iLeft,iTop),renderAd(e)},popup:function(e){var t=document.createElement("div");if(t.setAttribute("id","BlackOutDiv"),t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.style.zIndex=99999,t.style.backgroundColor="black",t.style.opacity=.9,t.style.filter="alpha(opacity=90)",typeof window.innerWidth=="number")iWinWidth=window.innerWidth,iWinHeight=window.innerHeight;else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))iWinWidth=document.documentElement.clientWidth,iWinHeight=document.documentElement.clientHeight;else if(document.body&&(document.body.clientWidth||document.body.clientHeight))iWinWidth=document.body.clientWidth,iWinHeight=document.body.clientHeight;else throw new Error("No valid hight or width for the current window could be found");iWidth=e.width||400,iHeight=e.height||400,iAdLeft=parseInt((iWinWidth-iWidth)/2),iAdLeft=iAdLeft>0?iAdLeft:0,iAdTop=parseInt((iWinHeight-iHeight)/2),iAdTop=iAdTop>0?iAdTop:0;var o=document.createElement("div");o.style.position="absolute",o.style.top=iAdTop+"px",o.style.left=iAdLeft+"px",o.style.zIndex=parseInt(t.style.zIndex)+1,o.setAttribute("id","blox-ad-position-_popup1");function n(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("blox-ad-position-_popup1")),document.getElementsByTagName("body")[0].removeChild(document.getElementById("BlackOutDiv"))}typeof t.addEventListener<"u"?t.addEventListener("click",n,!1):(document.compatMode=="BackCompat"&&(t.style.width="110%",t.style.height="110%",t.style.position="absolute"),t.attachEvent("onclick",n)),document.getElementsByTagName("body")[0].appendChild(t),document.getElementsByTagName("body")[0].appendChild(o),e.positionDiv=document.getElementById("blox-ad-position-_popup1"),renderAd(e)}};if(iDebug>0&&(typeof console>"u"?alert("Please turn on the debugging console!"):(info("Debug level set to: "+iDebug),bCanLog=!0)),window.XMLHttpRequest?oReq=new XMLHttpRequest:window.ActiveXObject&&(oReq=new ActiveXObject("MSXML2.XMLHTTP.3.0")),oReq){oReq.onreadystatechange=function(){if(oReq.readyState==4&&oReq.status==200){var oResponse=eval("("+oReq.responseText+")");oResponse.lat!==""&&oResponse.long!==""&&(kLocation={lat:oResponse.lat,long:oResponse.long})}};try{oReq.open("GET","/_services/v1/client_ip_info/"),oReq.send()}catch(e){}}aTime=location.search.match(/(\?|\&)adman_debug_time=(\d\d)\/(\d\d)\/(\d\d\d\d)_(\d\d)-(\d\d)/),oCurrent=aTime?new Date(aTime[4],aTime[2]-1,aTime[3],aTime[5],aTime[6]):new Date,sBound=oCurrent.getHours()*4+Math.floor(oCurrent.getMinutes()/15);var oDayPart={day:oCurrent.getDay(),startBound:sBound,endBound:sBound+1};delete aTime,delete oCurrent,delete sBound,aTag=document.getElementsByTagName("meta"),oKeyword={},aKeyword=[];for(var i=0;i<aTag.length;i++)if(aTag[i].name.toLowerCase()=="keywords"){aTemp=aTag[i].content.split(",");for(var j=0;j<aTemp.length;j++)sTemp=aTemp[j].replace(/^\s+|\s+$/g,""),sTemp&&(oKeyword[" "+sTemp+" "]=1)}for(var s in oKeyword)aKeyword.push(s);var sMetaKeywords=aKeyword.join(",").toLowerCase();delete aTag,delete oKeyword,delete aKeyword,docPath=document.location.href.replace(/\?.*/,"").replace(/#\w+/,""),sPath="",docPath.match(/^https:\/\/.+\/\-(\/[^#?\s]+)/)?sPath=RegExp.$1.replace(/\/[a-z0-9_\-]+\..+$/i,""):(docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)([\w\-\.]+\.[^#?\s]+)(#[\w\-]+)?$/)||docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)?$/))&&(sPath=RegExp.$4);var sDefaultSection=sPath=="/"?"frontpage":sPath.replace(/^\//,"").replace(/\/$/,"");delete docPath,delete sPath;for(regionType in kVirtualRegionCallback)typeof window["tncms_virtual_region_"+regionType]=="function"&&(kVirtualRegionCallback[regionType]=window["tncms_virtual_region_"+regionType]);function init(e){if(e=e||{},e.debug&&(iDebug=e.debug,iDebug>0&&(typeof console>"u"?alert("Please turn on the debugging console!"):(info("Debug level set to: "+iDebug),bCanLog=!0))),e.domain&&(e.domain=normDomain(e.domain)),domainConfig(e)&&(e.slot||(sDefaultDomain?warn("Changing the default domain from "+sDefaultDomain+" to "+e.domain+"."):info("Setting the default domain to "+e.domain+"."),sDefaultDomain=e.domain,sDefaultSecureDomain=e.secureDomain),!window.TNCMS.Tracking&&!bTracker?(info("Start loading tracking script"),bTracker="loading",loadScript(e,"/shared-content/art/tncms/tracking.js",function(){bTracker=!0,info("Finished loading tracker script"),renderAll()})):window.TNCMS.Tracking&&!bTracker&&(bTracker=!0)),e.virtualregion)for(regionType in kVirtualRegionCallback)e.virtualregion&&e.virtualregion[regionType]&&(kVirtualRegionCallback[regionType]=e.virtualregion[regionType]);if(e.callback)for(adType in kAdCallback)adType=="dotconnect"||adType=="html"||adType=="video"||e.callback&&e.callback[adType]&&(kAdCallback[adType]=e.callback[adType])}function setImpressions(e,t){e=normDomain(e),kImpressions[e]=t}function setTraffic(e,t){e=normDomain(e),kTraffic[e]=t}function setSettings(e,t){e=normDomain(e),kSettings[e]=t,kSettings[e].trafficSmoothing&&info("Traffic smoothing active on "+e)}function info(e){iDebug&1&&bCanLog&&console.info(e)}function warn(e){iDebug&2&&bCanLog&&console.warn(e)}function error(e){iDebug&4&&bCanLog&&console.error(e)}function loadScript(e,t,o){if(e=e||{},!e.domain||!e.secureDomain)throw new Error("Failed to load script ("+t+"): valid domain data not detected");domain=location.protocol=="https:"?e.secureDomain:e.domain;var n=document.createElement("script");if(n.src=location.protocol+"//"+domain+t,n.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(n),typeof o=="function")if(typeof n.addEventListener<"u")n.addEventListener("load",o,!1);else{let c=function(){n.readyState=="loaded"&&o()};var l=c;n.attachEvent("onreadystatechange",c)}return n}function normDomain(e){return e&&e.length>0?e.replace(/^www\./i,""):""}function positionIsAutoPlay(e){return getPositionSetting(e,"video_autoplay",0)==1}function getPositionSetting(e,t,o){if(!kSettings)return warn("Settings not loaded"),o;var n=normDomain(sDefaultDomain),l=e.region,c=e.slot,m=e.section;return kSettings[n]?kSettings[n][l]?kSettings[n][l][c]?kSettings[n][l][c][m]?kSettings[n][l][c][m][t]&&kSettings[n][l][c][m][t]!=o?kSettings[n][l][c][m][t]:o:(warn("No slot settings for: "+l+" at slot: "+c+" with section: "+m),o):(warn("No slot settings for: "+l+" at slot: "+c),o):(warn("No position settings for: "+l),o):(warn("No settings found for: "+n),o)}function domainConfig(e){if(!e.domain||!e.secureDomain)return!1;var t=normDomain(e.domain);return kDomain[t]?!0:kImpressions[t]&&kTraffic[t]&&kSettings[t]?(info("Using existing configs for "+t),kPositionList[t]=kPositionList[t]||[],kDomain[t]=!0,!0):(kImpressions[t]?info("Using existing impression data for "+t):(info("Start loading impression data for "+t),loadScript(e,"/content/tncms/ads/impressions.js",function(){info("Finished loading impression data for "+t),kTraffic[t]&&kSettings[t]&&(kDomain[t]=!0,renderDomain(t))})),kTraffic[t]?info("Using existing traffic data for "+t):(info("Start loading traffic data for "+t),loadScript(e,"/content/tncms/ads/traffic.js",function(){info("Finished loading traffic data for "+t),kImpressions[t]&&kSettings[t]&&(kDomain[t]=!0,renderDomain(t))})),kSettings[t]?info("Using existing settings for "+t):(info("Start loading settings for "+t),loadScript(e,"/content/tncms/ads/settings.js",function(){info("Finished loading settings for "+t),kImpressions[t]&&kTraffic[t]&&(kDomain[t]=!0,renderDomain(t))})),kPositionList[t]=[],kDomain[t]="loading",!0)}function render(e){if(e=e||{},init(e),e.domain=e.domain||sDefaultDomain,e.secureDomain=e.secureDomain||sDefaultSecureDomain,!e.region||!e.slot)return warn("No valid position"),warn(e),!1;if(aRegionType=e.region.match(/^\_(.*)$/),e.regionType=aRegionType&&aRegionType[1]?aRegionType[1]:"inline",!document.getElementById("blox-ad-position-"+e.region+e.slot)&&e.regionType=="inline"){if(TNCMS_PAGE_LOADED)return warn("The div for position ("+e.region+e.slot+") does not exist!"),!1;document.write(`
<div id="blox-ad-position-`+e.region+e.slot+`"></div>
`)}return renderPosition(e)}function renderDomain(e){if(e=normDomain(e),bTracker!==!0)return info("Rendering deferred for "+e+": Tracker script has not been loaded"),!1;if(kDomain[e]!==!0)return info("Rendering deferred for "+e+": Config scripts have not been loaded"),!1;if(kPositionList[e].length==0)return info("No positions for "+e+" currently need rendering"),!1;for(;oConfig=kPositionList[e].shift();)renderPosition(oConfig)}function refresh(e){if(e=e||{},e.all){for(sDomain in kRenderedPositionList)refresh({domain:sDomain});return!0}if(e.domain&&(e.domain=normDomain(e.domain)),e.region&&e.slot){if(sDomain=e.domain||sDefaultDomain,kRenderedPositionList[sDomain]&&kRenderedPositionList[sDomain][e.region]&&kRenderedPositionList[sDomain][e.region][e.slot]){if(!kSettings[e.domain][e.region]||!kSettings[e.domain][e.region].refreshable)return info("Ads for "+sDomain+" in "+e.region+" are not refreshable."),!1;info("Refreshing ads for "+sDomain+" in "+e.region+e.slot),renderPosition(kRenderedPositionList[sDomain][e.region][e.slot])}return!0}if(e.region){if(sDomain=e.domain||sDefaultDomain,!kSettings[sDomain][e.region]||!kSettings[sDomain][e.region].refreshable)return info("Ads for "+sDomain+" in "+e.region+" are not refreshable."),!1;for(sSlot in kRenderedPositionList[sDomain][e.region])e.slot=sSlot,refresh({domain:sDomain,region:e.region,slot:sSlot});return!0}if(sDomain=e.domain||sDefaultDomain,!kRenderedPositionList[sDomain])return info("No ads to refresh for "+sDomain),!1;for(sRegion in kRenderedPositionList[sDomain])refresh({domain:sDomain,region:sRegion});return!0}function renderAll(){if(bTracker!==!0)return info("Rendering deferred: Tracker script has not been loaded"),!1;for(sDomain in kPositionList)renderDomain(sDomain);for(;oAd=aRenderAdList.shift();)renderAd(oAd)}function renderPosition(e){if(e=e||{},e.domain&&(e.domain=normDomain(e.domain)),kDomain[e.domain]!==!0||bTracker!==!0)return kPositionList[e.domain]=kPositionList[e.domain]||[],kPositionList[e.domain].push(e),!0;if(sPositionCookie=readCookie("tncms_position_"+e.region+"_"+e.slot),sPositionCookie&&(aData=sPositionCookie.split("&"),iFrequency=parseInt(aData[0],10),nMinutes=(new Date(unescape(aData[1]))-new Date)/6e4,nMinutes>0)){iMinutes=parseInt(nMinutes,10),sMessage="The position "+e.region+e.slot+" has met its frequency cap, which is set to "+iFrequency+" minutes. This position will be available again in ",iMinutes==0?sMessage+="under a minute.":iMinutes==1?sMessage+="around a minute.":sMessage+="around "+iMinutes+" minutes.",warn(sMessage),sMessage="<!-- "+sMessage+" -->";try{document.getElementById("blox-ad-position-"+e.region+e.slot).innerHTML=sMessage}catch{}return!1}if(e.position=e.region+e.slot,e.cdn=kSettings[e.domain].cdn||null,e.section=e.section?e.section:sDefaultSection,kAdList[e.domain]=kAdList[e.domain]||{},kAdList[e.domain][e.region]=kAdList[e.domain][e.region]||{},kAdList[e.domain][e.region][e.slot]=kAdList[e.domain][e.region][e.slot]||!1,!e.adList&&!kAdList[e.domain][e.region][e.slot]&&!e.finalRender)return info("Attempting to load ads for "+e.domain+" in "+e.region+e.slot),loadScript(e,"/content/tncms/ads/"+escape(e.region)+"/"+e.slot+".js",function(){return info("Finished loading ads for "+e.domain+" in "+e.region+e.slot),e.finalRender=!0,renderPosition(e)}),!1;(!kRenderedPositionList[e.domain]||!kRenderedPositionList[e.domain][e.region]||!kRenderedPositionList[e.domain][e.region][e.slot])&&(kRenderedPositionList[e.domain]=kRenderedPositionList[e.domain]||{},kRenderedPositionList[e.domain][e.region]=kRenderedPositionList[e.domain][e.region]||{},kRenderedPositionList[e.domain][e.region][e.slot]=e);for(iAd in TNCMS_Used_Ad)if(TNCMS_Used_Ad[iAd]==e.position){info("Removing ad #"+iAd+" from used ad list."),delete TNCMS_Used_Ad[iAd];break}try{return info("Generating ad for "+e.domain+" in "+e.position),oAd=getAd(e),kVirtualRegionCallback[oAd.regionType]?kVirtualRegionCallback[oAd.regionType](oAd):renderAd(oAd)}catch(t){t.name=="Warning"?warn(t.message):error(t.message),oPositionDiv=document.getElementById("blox-ad-position-"+e.position),oPositionDiv&&(oPositionDiv.innerHTML="<!-- "+t.message+" -->")}return!1}function renderAd(e){if(!e.type)throw new Error("No ad type was found.");if(!kAdCallback[e.type])throw new Error('No callback for type "'+e.type+" was found.");if(kDomain[e.domain]!==!0||bTracker!==!0)return aRenderAdList.push(e),!0;if(iDebug&1&&bCanLog){var t={};for(x in e)t[x]=e[x];info(t)}kAdCallback[e.type](e),TNCMS.Tracking.addEvent({domain:TNCMS.AdManager.isSecure?e.secureDomain:e.domain,app:"bannerad",metric:"impressions",id:e.section+"/"+e.position+"/"+e.uuid}),e.type!="dotconnect"&&(TNCMS_Used_Ad[e.adid]=e.position);var o=normDomain(e.domain);if(kSettings[o][e.region][e.slot]&&kSettings[e.domain][e.region][e.slot][e.section]&&kSettings[e.domain][e.region][e.slot][e.section].frequency&&(iFrequency=parseInt(kSettings[o][e.region][e.slot][e.section].frequency,10),iFrequency>0&&!readCookie("tncms_position_"+e.region+"_"+e.slot))){var n=new Date;n.setTime(n.getTime()+iFrequency*6e4),info("Creating frequency cookie for "+e.region+e.slot+". It will expire in "+iFrequency+" minutes."),document.cookie="tncms_position_"+e.region+"_"+e.slot+"="+iFrequency+"&"+escape(n.toUTCString())+"; expires="+n.toUTCString()+"; path=/"}if(e.frequency_limit){if(sCookieName="tncms_ad_"+e.adid,sCookieValue=readCookie(sCookieName),sCookieValue)aData=sCookieValue.split("&"),nAdCount=parseInt(aData[0],10)+1,info("Incrementing frequency limit cookie for "+e.adid),document.cookie=sCookieName+"="+nAdCount+"&"+aData[1]+"; expires="+unescape(aData[1])+"; path=/";else if(e.frequency_number&&e.frequency_type){var n=new Date;switch(e.frequency_type){case"minutes":n.setTime(n.getTime()+e.frequency_number*6e4);break;case"hours":n.setTime(n.getTime()+e.frequency_number*36e5);break;case"days":n.setTime(n.getTime()+e.frequency_number*864e5);break}var l="; expires="+n.toUTCString();info("Creating frequency limit cookie for "+e.adid),document.cookie=sCookieName+"=1&"+escape(n.toUTCString())+l+"; path=/"}}return!0}function renderStandaloneVideo(e){if(!e){warn("Could not render video. Missing required objects.");return}if(!e.asseturl.match(/\.mp4$/i)){warn("Could not render video. Unsupported format.");return}if(e.positionDiv.childNodes&&e.positionDiv.childNodes.length>0){if(document.getElementById("tncms-admanager-video-player-"+e.adid)){info("Ad already rendered.");return}for(var t in e.positionDiv.children)info("Removing existing child elements to render new ad."),e.positionDiv.children[t].nodeType===1&&e.positionDiv.removeChild(e.positionDiv.children[t])}if(info("Rendering standalone video"),oAd.clickuri){var o=document.createElement("div");o.setAttribute("class","tncms-admanager-video-click-cnt");var n=document.createElement("a");n.setAttribute("class","tncms-admanager-video-click-url"),n.setAttribute("href",oAd.clickuri),n.setAttribute("target",e.target||"_blank"),n.setAttribute("onclick","tncmsAdmanagerVideoCtrl('"+e.adid+"', 'pause')"),n.innerHTML="Click here for details"}var l=document.createElement("style");l.appendChild(document.createTextNode(`.tncms-admanager-video-cnt { width: 100%; height: 100%; text-align: center;}
.tncms-admanager-video-inner-cnt { display:inline-block; position:relative;}
.tncms-admanager-video-click-cnt { position: absolute; right: 10px; top: 10px; z-index: 1; padding: 5px 5px; font-size: 16px; font-family: Helvetica; color: #FFF; background-color: rgba(50, 50, 50, 0.3);}
video { width: 100%; height: 100%;}
.tncms-admanager-video-click-cnt a { color: #DDD;}
`));var c=document.createElement("script");c.setAttribute("type","text/javascript"),c.innerHTML=" var tncmsAdmanagerVideoCtrl = function (sAdID, sAction) {  var oPlayer = document.getElementById('tncms-admanager-video-player-' + sAdID);  if ( oPlayer ) {    switch(sAction) {        case 'pause':          oPlayer.pause();          break;       case 'play':         oPlayer.play();         break;    }  }} ";var m=document.createElement("div");m.setAttribute("class","tncms-admanager-video-cnt"),m.setAttribute("id","tncms-admanager-video-"+e.adid);var k=document.createElement("div");k.setAttribute("class","tncms-admanager-video-inner-cnt");var f=document.createElement("video");f.setAttribute("controls",""),f.setAttribute("loop",""),f.setAttribute("class","tncms-admanager-video"),f.setAttribute("id","tncms-admanager-video-player-"+e.adid),f.setAttribute("width",e.width),f.setAttribute("height",e.height),e.poster&&f.setAttribute("poster",e.poster),positionIsAutoPlay(e)?(f.setAttribute("autoplay",""),f.setAttribute("muted","")):f.setAttribute("onloadstart","this.volume=0.5");var v=document.createElement("source");v.setAttribute("src",e.asseturl),v.setAttribute("type","video/mp4"),f.appendChild(v),f.appendChild(document.createTextNode("Video not supported by browser.")),n&&o&&(o.appendChild(n),k.appendChild(o)),k.appendChild(f),m.appendChild(k),e.positionDiv.appendChild(l),e.positionDiv.appendChild(c),e.positionDiv.appendChild(m)}function setAds(e,t,o,n){var l=normDomain(e);kAdList[l]=kAdList[l]||{},kAdList[l][t]=kAdList[l][t]||{},kAdList[l][t][o]=n}function getAd(oPosition){var sNormDomain=normDomain(oPosition.domain);if(oPosition.adList)info("Caching passed ads for "+oPosition.domain+" in "+oPosition.region+oPosition.slot),setAds(oPosition.domain,oPosition.region,oPosition.slot,oPosition.adList),oAdList=oPosition.adList;else if(kAdList[sNormDomain][oPosition.region][oPosition.slot])info("Using cached ads for "+sNormDomain+" in "+oPosition.region+oPosition.slot),oAdList=kAdList[sNormDomain][oPosition.region][oPosition.slot];else throw{name:"Warning",message:"No ads found in cache for "+sNormDomain+" in "+oPosition.region+oPosition.slot};for(iAd in oAdList){if(oPosition.region=="_popunder"&&(oAdList[iAd].type=="expandable"||oAdList[iAd].type=="pagecurl")){info("Removing ad #"+oAdList[iAd].adid+" because "+oAdList[iAd].type+" ads are not allowed in a popunder."),delete oAdList[iAd];continue}if(TNCMS_Used_Ad[iAd]){info("Removing ad #"+oAdList[iAd].adid+" because it is already being displayed."),delete oAdList[iAd];continue}if(!oAdList[iAd].uri&&(oAdList[iAd].type=="image"||oAdList[iAd].type=="video")){info("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because it is missing the mandatory asset uri."),delete oAdList[iAd];continue}if(oAdList[iAd].type=="html"&&location.protocol=="https:"&&!oAdList[iAd].secure){info("Removing ad #"+oAdList[iAd].adid+" because is not a secure HTML ad."),delete oAdList[iAd];continue}if(!kAdCallback[oAdList[iAd].type]){info("Removing ad #"+oAdList[iAd].adid+" because it is of type ("+oAdList[iAd].type+") and there is no callback registerd for that."),delete oAdList[iAd];continue}if(oAdList[iAd].type=="dotconnect"&&TNCMS_DotConnect_Tile>16){info("Removing ad #"+oAdList[iAd].adid+" because it is a DotConnect ad and there are already 16 DoctConnect ads on this page."),delete oAdList[iAd];continue}if(oAdList[iAd].keywords&&Object.keys(oAdList[iAd].keywords).length!==0){bKeep=0;for(var sKey in oAdList[iAd].keywords){var oRegex=new RegExp(" "+oAdList[iAd].keywords[sKey].toLowerCase()+" ","");if(sMetaKeywords.match(oRegex)){bKeep=1;break}}if(!bKeep){info("Removing ad #"+oAdList[iAd].adid+" because it does not match any keywords on this page."),delete oAdList[iAd];continue}}var oToday=new Date,oStartDate=new Date,oEndDate=new Date,aDateParts=oAdList[iAd].startdate.split("-");if(oStartDate.setFullYear(aDateParts[0],aDateParts[1]-1,aDateParts[2]),aDateParts=oAdList[iAd].enddate.split("-"),oEndDate.setFullYear(aDateParts[0],aDateParts[1]-1,aDateParts[2]),oStartDate>oToday){info("Removing ad #"+oAdList[iAd].adid+" because it has not yet started."),delete oAdList[iAd];continue}if(oEndDate<oToday){info("Removing ad #"+oAdList[iAd].adid+" because it has already ended."),delete oAdList[iAd];continue}if(oPosition.width&&oAdList[iAd].width&&oAdList[iAd].width>oPosition.width){info("Removing ad #"+oAdList[iAd].adid+" because it is too wide for this region."),delete oAdList[iAd];continue}if(kImpressions[sNormDomain].daily[iAd]&&oAdList[iAd].dailyLimit&&oAdList[iAd].dailyLimit<=kImpressions[oPosition.domain].daily[iAd]){info("Removing ad #"+oAdList[iAd].adid+" because it has already met its daily impression limit."),delete oAdList[iAd];continue}if(kImpressions[sNormDomain].total[iAd]&&oAdList[iAd].totalLimit&&oAdList[iAd].totalLimit<=kImpressions[oPosition.domain].total[iAd]){info("Removing ad #"+oAdList[iAd].adid+" because it has already met its total impression limit."),delete oAdList[iAd];continue}if(oAdList[iAd].daypart_enabled&&oAdList[iAd].daypart_enabled!=""){if(!oAdList[iAd].daypart_schedule){info("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled but there is not schedule."),delete oAdList[iAd];continue}var adSchedule=eval("("+oAdList[iAd].daypart_schedule+")");if(!adSchedule[oDayPart.day]){info("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled and this day is not in the schedule."),delete oAdList[iAd];continue}if(!adSchedule[oDayPart.day].allday&&(!adSchedule[oDayPart.day][oDayPart.startBound]||!adSchedule[oDayPart.day][oDayPart.endBound])){info("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled and it is not in the the start or end bound."),delete oAdList[iAd];continue}}if(oAdList[iAd].frequency_limit&&(sValue=readCookie("tncms_ad_"+iAd),sValue&&(aData=sValue.split("&"),nAdCount=parseInt(aData[0],10),nAdCount>=oAdList[iAd].frequency_limit))){info("Removing ad #"+oAdList[iAd].adid+" because it has met its frequency limit."),delete oAdList[iAd];continue}if(oAdList[iAd].lat&&oAdList[iAd].long&&oAdList[iAd].proximity&&kLocation){var sinDeltaLat=Math.sin((kLocation.lat*Math.PI/180-oAdList[iAd].lat)/2),sinDeltaLong=Math.sin((kLocation.long*Math.PI/180-oAdList[iAd].long)/2),a=Math.pow(sinDeltaLat,2)+Math.pow(sinDeltaLong,2)*Math.cos(oAdList[iAd].lat)*Math.cos(kLocation.lat*Math.PI/180);if(7974*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))>oAdList[iAd].proximity){info("Removing ad #"+oAdList[iAd].adid+" because the reader was not detected within the configured porximity."),delete oAdList[iAd];continue}}}if(oAdList.length==0)throw{name:"Warning",message:"All ads have been eliminated from the ad list for this position ("+oPosition.region+oPosition.slot+")."};if(oSectionAds=getAdsBySection(oPosition.section,oAdList),sCurrentSection=oSectionAds.section,aAd=oSectionAds.ads,sCurrentSection=="ros"&&kSettings[sNormDomain].sectionExclusions){for(var i=0;i<kSettings[sNormDomain].sectionExclusions.length;i++)if(kSettings[sNormDomain].sectionExclusions[i]==oPosition.section||window.location.href.indexOf("/"+kSettings[sNormDomain].sectionExclusions[i]+"/")>-1)throw{name:"Warning",message:"ROS ads are excluded from this section ("+oPosition.section+") so no ads will be displayed for this position ("+oPosition.region+oPosition.slot+")."}}if(!aAd||aAd.length==0)throw{name:"Warning",message:"There are no ads available in this section ("+oPosition.section+") for this position ("+oPosition.region+oPosition.slot+")."};for(var nIterator=0,nLockedTotalPerc=0,nLimitedPerc=0,nUnlockedTotalPerc=0,nUnlockedAds=0,nNoAd=0,i=0;i<aAd.length;i++)aAd[i].weight=getAdWeightData(aAd[i],sCurrentSection,sNormDomain),aAd[i].weight.locked==1?(nLockedTotalPerc+=parseFloat(aAd[i].weight.percent),aAd[i].minRange=nIterator,aAd[i].maxRange=nIterator+1e4*parseFloat(aAd[i].weight.percent),info("Weight range for ad #"+aAd[i].adid+": "+aAd[i].minRange+" to "+aAd[i].maxRange),nIterator=aAd[i].maxRange):aAd[i].weight.locked==2?nLimitedPerc+=parseFloat(aAd[i].weight.percent):(nUnlockedTotalPerc+=parseFloat(aAd[i].weight.percent),nUnlockedAds++);if(nLimitedPerc+nUnlockedTotalPerc>100-nLockedTotalPerc)for(nMultiplier=(100-nLockedTotalPerc)/100,i=0;i<aAd.length;i++)aAd[i].weight.locked!=1&&(aAd[i].minRange=nIterator,aAd[i].maxRange=nIterator+1e4*parseFloat(aAd[i].weight.percent)*nMultiplier,info("Weight range for ad #"+aAd[i].adid+": "+aAd[i].minRange+" to "+aAd[i].maxRange),nIterator=aAd[i].maxRange);else if(nLimitedPerc+nUnlockedTotalPerc<=100-nLockedTotalPerc)if(nUnlockedTotalPerc==0)for(nNoAd=100-nLockedTotalPerc-nLimitedPerc,i=0;i<aAd.length;i++)aAd[i].weight.locked!=1&&(aAd[i].minRange=nIterator,aAd[i].maxRange=nIterator+1e4*parseFloat(aAd[i].weight.percent),info("Weight range for ad #"+aAd[i].adid+": "+aAd[i].minRange+" to "+aAd[i].maxRange),nIterator=aAd[i].maxRange);else for(nNewPercent=(100-nLockedTotalPerc-nLimitedPerc)/nUnlockedAds,i=0;i<aAd.length;i++)aAd[i].weight.locked!=1&&(nPercent=aAd[i].weight.locked<1?nNewPercent:aAd[i].weight.percent,aAd[i].minRange=nIterator,aAd[i].maxRange=nIterator+1e4*parseFloat(nPercent),info("Weight range for ad #"+aAd[i].adid+": "+aAd[i].minRange+" to "+aAd[i].maxRange),nIterator=aAd[i].maxRange);nIterator+=nNoAd;for(var randomWeight=Math.floor(Math.random()*nIterator),i=0;i<aAd.length;i++)if(aAd[i].minRange<=randomWeight&&aAd[i].maxRange>randomWeight){info("Ad #"+aAd[i].adid+"(type: "+aAd[i].type+") chosen from "+oPosition.domain+" to display in "+oPosition.region+oPosition.slot),oAd=Object.create(aAd[i]);for(sFieldName in oPosition)sFieldName!="finalRender"&&!oAd[sFieldName]&&(oAd[sFieldName]=oPosition[sFieldName]);if(oAd.originalSection=oPosition.section,oAd.section=sCurrentSection,oAd.position=oPosition.region+oPosition.slot,oAd.cdn&&(oAd.asseturl="https://"+oAd.cdn+oAd.uri),oAd.window=window,iDebug&1&&typeof kVirtualRegionCallback[oAd.regionType]!="function"?(debugHeaderDiv=document.getElementById("blox-ad-position-debug-header-"+oAd.position),debugHeaderDiv?oAd.positionDiv=document.getElementById("blox-ad-position-"+oAd.position):(debugDiv=document.getElementById("blox-ad-position-"+oAd.position),debugDiv.setAttribute("id","blox-ad-position-debug-"+oAd.position),debugHeaderDiv=document.createElement("div"),debugHeaderDiv.style.border="1px solid black",debugHeaderDiv.style.width="100%",debugHeaderDiv.setAttribute("id","blox-ad-position-debug-header-"+oAd.position),debugDiv.appendChild(debugHeaderDiv),oAd.positionDiv=document.createElement("div"),oAd.positionDiv.setAttribute("id","blox-ad-position-"+oAd.position),debugDiv.appendChild(oAd.positionDiv)),debugHeaderDiv.innerHTML=" Ad Position: "+oAd.section+" : "+oAd.region+" : "+oAd.slot+" Ad ID: "+oAd.adid+" ("+oAd.type+":API 2)"):oAd.positionDiv=document.getElementById("blox-ad-position-"+oAd.position),oAd.clickuri?(clickuri=oAd.clickuri.match(/^[htpsmailo]+:/i)?oAd.clickuri:"http://"+oAd.clickuri,oAd.clickuri=TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:clickuri})):oAd.type=="html"&&oAd.html&&(trackerURL=location.protocol+TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:"TNCMS_AD_TRACKER"}),trackerURL=trackerURL.replace(/TNCMS_AD_TRACKER/,""),html=eval(oAd.html),oAd.html=html.replace(/__TRACKER_URL__/g,trackerURL)),oAd.type=="video"&&(oAd.rolltype="pre",oAd.autoplay=0,oAd.embed=0,oAd.volume=50,kSettings[normDomain(oAd.domain)][oAd.region][oAd.slot]&&kSettings[normDomain(oAd.domain)][oAd.region][oAd.slot][oAd.section])){var kSectionSettings=kSettings[normDomain(oAd.domain)][oAd.region][oAd.slot][oAd.section];oAd.rolltype=kSectionSettings.video_rolltype||oAd.rolltype,oAd.autoplay=kSectionSettings.video_autoplay?parseInt(kSectionSettings.video_autoplay,10):oAd.autoplay,oAd.embed=kSectionSettings.video_embed?parseInt(kSectionSettings.video_embed,10):oAd.embed,oAd.volume=kSectionSettings.video_volume?parseInt(kSectionSettings.video_volume,10):oAd.volume}return oAd}throw{name:"Warning",message:"No ad was selected from the list"}}function getAdWeightData(e,t,o){o=normDomain(o);for(adSection in e.weights)if(adSection==t){if(!kSettings[o].trafficSmoothing||e.ad_balancing=="asap")return info("On "+o+" using default weights (ASAP) for ad#"+e.adid),e.weights[adSection];if(!kTraffic[o].estimate||!kTraffic[o].ratio)return warn("No traffic data found for "+o+": using default weights for ad#"+e.adid),e.weights[adSection];var n=new Date;return iHour=n.getHours(),nTrafficEstimate=kTraffic[o].estimate[iHour]||0,nTrafficRatio=kTraffic[o].ratio[iHour]||0,e.dailyLimit&&kImpressions[o].daily[e.adid]&&nTrafficRatio&&nTrafficEstimate?(nWantedImpressions=(e.dailyLimit-kImpressions[o].daily[e.adid])*nTrafficRatio,nWantedImpressions>=nTrafficEstimate?(info("Wanted impressions for "+e.adid+" is greater than the current traffic estimate: using default weights for ad#"+e.adid),e.weights[adSection]):(nWeight=nWantedImpressions/nTrafficEstimate,info("Overriding default weight: using traffic curve for ad#"+e.adid),{section:t,percent:100*nWeight,locked:2})):(info("Using default weight in favor of traffic curve for ad#"+e.adid),e.weights[adSection])}return warn("No weight data found for ad#"+e.adid+" found: using 0"),0}function getAdsBySection(e,t){oValidAds=[];for(nAdId in t)for(var o=t[nAdId].sections,n=0;n<o.length;n++)o[n]==e&&oValidAds.push(t[nAdId]);return oValidAds.length>0||e=="ros"?(info("Returning ads for section: "+e),{section:e,ads:oValidAds}):(sMatch=e.match(/(\/[\w\-]+)$/g),sMatch?getAdsBySection(e.replace(sMatch,""),t):getAdsBySection("ros",t))}function readCookie(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var l=o[n];l.charAt(0)==" ";)l=l.substring(1,l.length);if(l.indexOf(t)==0)return l.substring(t.length,l.length)}return null}var jsLoader=function(){var e=!1,t=[],o=[],n={},l=0,c={},m=[],k=/(<script[\s\S]*?<\/script>)/gim,f=null,v=document.getElementsByTagName("head")[0]||document.documentElement,B="abc".split(/(b)/)[1]==="b";function S(){t.length?R(t.shift()):l===0&&(info("jsLoader: Auto-releasing"),f.release())}function E(d){var r=n[d.domId],u;if(r&&r.length)G(r.shift(),d);else{for(;m.length>0;){u=m.pop();var g=u.id,p=_(g);if(p){var h=p.parentNode;p.id=g+"__tmp",h.insertBefore(u,p),h.removeChild(p)}}S()}}function N(d){var r=d.domId,u,g;u=K(o.join("")),o=[],g=O(u),n[r]?Array.prototype.unshift.apply(n[r],g):n[r]=g,E(d)}function W(d){return c[d]||(c[d]=document.getElementById(d))}function _(d){return f.originalGetElementById.call?f.originalGetElementById.call(document,d):f.originalGetElementById(d)}function H(d){var r=_(d),u,g,p,h;function y(T,L){var A=L.children,w,C,b;if(A&&A.length)for(w=0,C=A.length;w<C;w++){if(b=A[w],b.id&&b.id===T)return b;if(b.children&&b.children.length){var P=y(T,b);if(P)return P}}}function D(T){var L,A,w;for(L=0,A=m.length;L<A;L++)if(w=m[L],w.id===T)return w}if(r)return r;if(m.length&&(h=D(d),h))return h;if(o.length)return u=o.join(""),g=document.createDocumentFragment(),p=document.createElement("div"),p.innerHTML=u,g.appendChild(p),h=y(d,p),h&&m.push(h),h}var q=function(){return window.execScript?function(d,r){window.execScript(d,r||"JavaScript")}:function(d,r){r&&!/^javascript/i.test(r)||window.eval.call(window,d)}}();function F(d){return d.toLowerCase().indexOf("<script")===0}function R(d){l++;var r=document.createElement("script");d.type&&(r.type=d.type),d.charset&&(r.charset=d.charset),d.language&&(r.language=d.language),M(d);var u=!1;r.onload=r.onreadystatechange=function(){l--,r.loaded=!0,!u&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(u=!0,r.onload=r.onreadystatechange=null,info("jsLoader: #"+d.domId+": onload "+d.src),N(d))},r.loaded=!1,r.src=d.src,v.insertBefore(r,v.firstChild),setTimeout(function(){if(!r.loaded)throw new Error("jsLoader: SCRIPT NOT LOADED: "+r.src)},3e3)}function M(d,r,u){info("jsLoader: #"+d.domId+(r?": Inline "+u+": "+r.replace(`
`," ").substr(0,30)+"...":": Inject "+d.src))}function O(d){return U(d,k)}function U(d,r){var u,g=0,p,h=[],y,D;if(B)p=d.split(r);else{for(p=[];u=r.exec(d);)u.index>g&&h.push(d.slice(g,u.index)),u.length>1&&u.index<d.length&&Array.prototype.push.apply(p,u.slice(1)),g=r.lastIndex;g<d.length&&p.push(d.slice(g))}for(y=0,D=p.length;y<D;y=y+1)p[y]!==""&&h.push(p[y]);return h}function K(d){return d.replace(/<noscript>[\s\S]*?<\/noscript>/ig,"")}function I(d){return d&&d.replace(/^\s*|\s*$/gi,"")}function G(d,r){if(F(d)){var u=document.createElement("div");u.innerHTML="dummy<div>"+d+"</div>";var g=u.children[0].children[0],p=g.getAttribute("language")||"javascript";if(g.src)r.src=g.src,r.charset=g.charset,r.language=p,r.type=g.type,R(r);else{var h=I(g.text);h&&(M(r,h,p),q(h,p)),N(r)}}else{var y=W(r.domId);if(!y)throw new Error('jsLoader: Unable to inject html. Element with id "'+r.domId+'" does not exist');d=I(d),d&&(y.innerHTML+=d),E(r)}}function $(d){o.push(d),info("jsLoader: write: "+d)}function z(){return document}function X(){}return f={activate:function(){e||(document.write=document.writeln=$,document.open=z,document.close=X,document.getElementById=H,e=!0)},release:function(){e&&(document.write=this.originalWrite,document.writeln=this.originalWriteLn,document.open=this.originalOpen,document.close=this.originalClose,document.getElementById=this.originalGetElementById,c={},e=!1)},loadScript:function(d,r){if(typeof r!="string")throw new Error("jsLoader: No valid DOM ID found for "+d);e||(info("jsLoader: Auto-activating"),this.activate()),t.push({src:d,domId:r}),setTimeout(function(){l===0&&S()},1)},originalGetElementById:document.getElementById,originalWrite:document.write,originalWriteLn:document.writeln,originalOpen:document.open,originalClose:document.close},f}();return{info,warn,error,init,setImpressions,setTraffic,setSettings,setAds,render,renderAd,refresh,isSecure}}());
//# sourceMappingURL=admanager.js.map
